[
 {
  "allow_guest": 0,
  "api_method": null,
  "cron_format": null,
  "disabled": 1,
  "docstatus": 0,
  "doctype": "Server Script",
  "doctype_event": "Before Save",
  "enable_rate_limit": 0,
  "event_frequency": "All",
  "modified": "2025-10-09 15:13:37.634876",
  "module": "User Branch Control",
  "name": "strict_user_to_allowed_branch",
  "rate_limit_count": 5,
  "rate_limit_seconds": 86400,
  "reference_doctype": "Sales Invoice",
  "script": "# Script Type: DocType Event\n# Reference DocType: Sales Invoice\n# DocType Event: Before Save\n\nif doc.branch:\n    user = frappe.session.user\n    \n    if user != \"Administrator\":\n        user_branch_record = frappe.get_all(\n            \"User Branch Control\",\n            filters={\n                \"user\": user,\n                \"branch\": doc.branch,\n                \"disable_write\": 1\n            },\n            limit=1\n        )\n        \n        if user_branch_record:\n            frappe.throw(\n                f\"ليس لديك صلاحية الكتابة في الفرع: {doc.branch}\",\n                title=\"صلاحية مقيدة\"\n            )",
  "script_type": "DocType Event"
 }
]